# USB-CDC通信协议

| 字段     | 字节数 |
| -------- | ------ |
| 帧头     | 2      |
| 功能码   | 1      |
| 数据长度 | 2      |
| 数据体   | 0-65535 |
|校验和|1|

## 帧头

固定为0xAA55。

## 功能码

| 功能码 | 功能描述 | 数据体 内容说明 |
| ------ | -------- | --------------- |
| 0x01   | **配置并发送SPI数据** | 包含SPI模式、速率配置、以及要发送的数据。 |
| 0x02   | **配置并发送I2C数据** | 包含I2C从机地址、读写标志、以及要发送的数据。 |
| 0x03   | **配置并发送UART数据** | 包含UART波特率、数据位、停止位、校验位配置，以及要发送的数据。 |
| 0x04   | **配置PWM输出** | 包含PWM通道号、周期、占空比。 |
| 0x11   | **接收SPI数据**        | FPGA通过这个指令将从SPI总线读取到的数据返回给PC。            |
| 0x12   | **接收I2C数据 ** | FPGA通过这个指令将从I2C总线读取到的数据返回给PC。 |
| 0x13   | **接收UART数据** | FPGA通过这个指令将从外部UART接收到的数据返回给PC。 |
|0xFF|**心跳测试**|用于测试PC与FPGA之间的通信是否正常，数据体为空。|

## 数据长度

- **值**: 16位无符号整数，例如 `0x000A` 表示数据体有10个字节。
- **字节序**: 大端模式（Big-Endian）**，即高字节在前。`0x000A` 发送时就是 `0x00` 先发，`0x0A` 后发。

## 数据体

## 校验和

将一个帧中从“指令码”到“数据体”结束的所有字节进行无符号加法运算，结果溢出就舍弃高位，只保留最低的8位。

